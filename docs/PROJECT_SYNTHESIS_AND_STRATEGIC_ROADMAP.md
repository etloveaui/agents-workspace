# 📜 프로젝트 종합 분석 및 미래 전략 로드맵 v2.0

**문서 버전:** 2.0
**작성자:** Gemini AI (System Architect 페르소나)
**최종 업데이트:** 2025-09-03

## 1.0 Executive Summary: 현주소와 나아갈 길

현재 `agents-workspace`는 과거의 실패로부터 배운 교훈을 바탕으로 잘 정돈된 **'메타 프레임워크'**의 기반을 갖추었다. 하지만, 현재 상태는 **'성공적인 단일 에이전트 시스템'**일 뿐, 과거에 꿈꿨던 **'지능형 멀티 에이전트 생태계'**라는 최종 비전에는 아직 도달하지 못했다. 

과거 `multi-agent-workspace`의 가장 큰 실패 원인이었던 **'파일 시스템 기반의 취약한 아키텍처'**를 반복할 위험이 여전히 존재하며, `dev-agents`의 실패 원인이었던 **'지나치게 야심 찬 목표'**를 다시 추상적으로 답습할 가능성 또한 배제할 수 없다.

본 문서는 이러한 상황을 타개하기 위해, 과거의 성공 요인(모듈식 프레임워크, 제로-셋업)은 계승하고 실패 요인(취약한 아키텍처, 무분별한 확장)은 원천 차단하는, **구체적이고 실행 가능한 기술 청사진과 단계별 로드맵**을 제시한다.

---

## 2.0 현재 `agents-workspace` 심층 진단

### 2.1. 긍정적 평가 (잘 되어가고 있는 점)

1.  **구조적 명확성**: `docs`, `projects`, `servers`, `.gemini` 등 역할 기반의 명확한 디렉터리 구조는 과거 `multi-agent-workspace`의 혼돈 상태를 성공적으로 극복했다.
2.  **프로젝트 독립성 원칙**: `projects/` 내 하위 프로젝트들의 Git 저장소를 분리하는 원칙은 시스템 전체의 안정성을 보장하는 핵심적인 규칙이다.
3.  **모듈식 프레임워크**: `.gemini/`는 `dev-agents`에서 증명된 모듈식 프롬프트 아키텍처를 계승하여, 에이전트의 행동을 체계적으로 관리할 수 있는 강력한 기반을 제공한다.

### 2.2. 비판적 평가 (잘못 가고 있거나, 위험한 점)

1.  **🔴 아키텍처의 부재 (CRITICAL)**: 현재 시스템은 에이전트 간의 통신 및 협업을 위한 **아키텍처가 전무**하다. 이는 `multi-agent-workspace`의 실패를 **형태만 바꾼 채로 반복할 가장 큰 위험 요소**이다. 새로운 에이전트를 추가하더라도, 이들이 소통할 방법이 없어 결국 고립된 단일 에이전트의 집합에 머무를 것이다.
2.  **🟡 추상적인 비전**: 로드맵은 '멀티 에이전트'를 언급하지만, 이를 어떤 기술로, 어떤 프로토콜로 구현할지에 대한 구체적인 청사진이 없다. 이는 `dev-agents`가 야심만만한 계획만 세우다 좌초된 전철을 밟을 수 있음을 시사한다.
3.  **🟡 불완전한 도구 체인**: `hello-mcp` 서버는 기능 확장의 가능성만 보여줄 뿐, 실제 의미 있는 작업을 수행할 수 없는 플레이스홀더(Placeholder)에 가깝다. 또한, 핵심 로직이 사용자에게 투명하게 공개된 스크립트가 아닌, Gemini라는 블랙박스 모델 내부에 의존하고 있다.

---

## 3.0 제안: 차세대 통합 시스템 아키텍처 (The Blueprint v3.0)

과거의 교훈을 바탕으로, 다음과 같이 구체적이고 검증된 기술을 사용한 차세대 아키텍처를 강력히 제안한다.

### 3.1. 핵심 아키텍처: Python + Redis + Invoke

-   **Core Orchestrator (`orchestrator.py`):** 모든 에이전트의 생명주기와 작업 흐름을 관리하는 중앙 관제탑 역할을 하는 단일 Python 애플리케이션을 개발한다. `invoke`는 이 오케스트레이터를 실행하는 진입점 역할만 수행한다.
-   **Communication Bus (Redis):** **파일 시스템을 완전히 배제하고, 산업 표준 인메모리 데이터 저장소인 `Redis`를 메시지 큐 및 상태 저장소로 도입한다.**
    -   **작업 큐**: Redis의 `LIST`를 사용하여 에이전트별 작업 큐를 구현한다. (`tasks:coder`, `tasks:planner`)
    -   **Pub/Sub**: Redis의 `PUBLISH/SUBSCRIBE` 기능을 사용하여 에이전트 간의 실시간 이벤트(e.g., "작업 완료", "도움 요청")를 전파한다.
    -   **상태 저장소**: Redis의 `HASH`를 사용하여 각 에이전트의 현재 상태(IDLE, WORKING, ERROR)를 실시간으로 저장하고 조회한다.
-   **Agent Implementation**: 각 전문 에이전트는 독립적인 Python 프로세스로 실행되며, 자신의 작업 큐를 `BLPOP` 명령어로 리스닝하여 블로킹 없이 효율적으로 작업을 수신한다.

### 3.2. AI 코드 수정 안전장치: Pre-Apply Workflow

-   `multi-agent-workspace`의 가장 빛나는 아이디어였던 '사전 검토'를 **Git 훅이 아닌, `invoke` 태스크 기반으로 표준화**한다.
    1.  AI 에이전트는 코드 수정을 원할 경우, 원본 파일을 직접 수정하는 대신 `patches/` 디렉터리에 `.diff` 파일을 생성한다.
    2.  사용자는 `invoke edits.list`로 제안된 모든 변경점을 확인한다.
    3.  `invoke edits.diff --id <ID>` 명령으로 특정 변경점의 내용을 상세히 검토한다.
    4.  `invoke edits.apply --id <ID>` 명령으로 변경점을 최종 승인하면, 시스템이 `patch` 명령어를 사용하여 원본 파일에 안전하게 적용한다. 이는 AI의 직접적인 파일 쓰기 권한을 원천 차단하는 강력한 안전장치이다.

---

## 4.0 실행 가능한 단계별 로드맵 (The Path Forward)

과거의 실패(지나치게 야심 찬 계획)를 반복하지 않기 위해, 한 번에 하나의 목표에만 집중하는 단계별 로드맵을 제안한다.

### Phase 0: 환경 구축 (1주)
-   **산출물**: `setup.py`, `requirements.txt`, `invoke.yaml`
-   [ ] `requirements.txt`에 `redis`, `invoke` 등 필수 라이브러리를 추가한다.
-   [ ] `invoke setup` 태스크를 만들어, `pip install` 및 로컬 Redis 서버(Docker 또는 직접 설치) 실행을 자동화한다.

### Phase 1: Orchestrator 및 첫 번째 Worker 구현 (2주)
-   **산출물**: `orchestrator.py`, `agents/coder_agent.py`
-   [ ] `orchestrator.py`: Redis에 연결하고, "new_tasks" 채널을 리스닝하는 기본 로직을 구현한다.
-   [ ] `agents/coder_agent.py`: "tasks:coder" 큐를 리스닝하고, 작업을 받으면 단순히 로그만 남기는 가장 간단한 형태의 워커 에이전트를 구현한다.
-   [ ] `invoke start.orchestrator`, `invoke start.coder` 태스크를 만든다.

### Phase 2: Dispatcher 및 통신 프로토콜 구현 (2주)
-   **산출물**: `agents/dispatcher_agent.py`, 표준화된 Task JSON 포맷
-   [ ] `agents/dispatcher_agent.py`: `smart_dispatcher.py`의 로직을 계승하되, 파일 시스템 대신 Redis를 사용하도록 재작성한다. "new_tasks" 큐에서 작업을 꺼내, 분석 후 `tasks:coder`와 같은 전문화된 큐에 `RPUSH`한다.
-   [ ] 에이전트 간에 주고받을 Task의 JSON 구조를 명확히 정의한다. (e.g., `{ "task_id": "...", "type": "code_generation", "params": { ... } }`)

### Phase 3: Pre-Apply 안전장치 구현 (1주)
-   **산출물**: `edits.py` Invoke 태스크 컬렉션
-   [ ] `invoke edits.list`, `edits.diff`, `edits.apply` 명령어를 구현하여, `patches/` 디렉터리의 `.diff` 파일을 관리하는 전체 워크플로우를 완성한다.

### Phase 4: 점진적 확장
-   [ ] 위 3단계가 완벽히 안정화된 이후에만, 두 번째 전문 에이전트(e.g., 'Planner' 에이전트) 추가를 고려한다.

---

## 5.0 결론: 나아가야 할 길

과거의 프로젝트들은 **'무엇을 만들 것인가'**에 대한 훌륭한 비전을 제시했지만, **'어떻게 만들 것인가'**에 대한 공학적 깊이가 부족하여 좌초했다. 현재 우리는 그들의 어깨 위에서 더 멀리 내다볼 수 있는 기회를 얻었다.

이제 추상적인 목표 설정은 중단하고, 본 보고서에 제시된 **Python, Redis, Invoke 기반의 구체적이고 안정적인 아키텍처**를 바탕으로, 한 번에 한 단계씩, 측정 가능하고 검증 가능한 시스템을 구축해 나가야 한다. 이것이 과거의 실수를 반복하지 않고, 진정한 **'지능형 멀티 에이전트 개발 환경'**을 완성하는 유일한 길이다.
